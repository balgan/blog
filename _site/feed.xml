<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2020-09-13T04:17:38+02:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">World of Balgan</title><subtitle>Welcome to my blog where I write about some of my interests and findings.</subtitle><entry><title type="html">Things I wish I knew before coming to infosec.</title><link href="http://localhost:4000/infosec/cybersecurity/2019/10/30/thingsiwishiknewinfosec.html" rel="alternate" type="text/html" title="Things I wish I knew before coming to infosec." /><published>2019-10-30T01:56:18+01:00</published><updated>2019-10-30T01:56:18+01:00</updated><id>http://localhost:4000/infosec/cybersecurity/2019/10/30/thingsiwishiknewinfosec</id><content type="html" xml:base="http://localhost:4000/infosec/cybersecurity/2019/10/30/thingsiwishiknewinfosec.html">&lt;p&gt;Over the last 12 years, I’ve worked in multiple roles in Information Security, from being a pentester to analyst, leading an infosec team responsible for a multi-million dollar company to running my own company in infosec, and there a couple of learnings that I believe, if I had known before coming to infosec would have led to two important outcomes:&lt;/p&gt;

&lt;p&gt;1 - Me having an easier life in infosec, and making life easier on others that I was working with/for.&lt;/p&gt;

&lt;p&gt;2 - Me acting differently on my career and picking up skills that I only did later much earlier.&lt;/p&gt;

&lt;p&gt;I thought that by making these learning public I could potentially help someone that is early in his career and thinking about either coming to infosec, or making the jump to infosec.&lt;/p&gt;

&lt;h3 id=&quot;if-you-work-in-infosec-you-are-well-paid-and-will-never-lack-a-job&quot;&gt;If you work in infosec you are well paid and will never lack a job&lt;/h3&gt;

&lt;p&gt;Like much of the tech market there is indeed a big lack of skilled people, and therefore a huge amount of openings, however much like any other job, you might specifically have certain requirements that are not 101 to be met.&lt;/p&gt;

&lt;p&gt;Maybe you like working from home, or maybe you live in a small village and aren’t willing to relocate (many jobs in infosec are in consultancy, therefore you need to be in bigger towns so that you can sit at clients), so in general, it should be fairly easy to find a job but it might not happen in less than 24 hours as lots of people make it seem to be.&lt;/p&gt;

&lt;p&gt;Salaries are indeed aligned with rest of tech, so you will be well compensated, but many times we hear about offers over $1 Million/year and its important that you are aware, this is not common, even within offsec. Some CISO level executives will get offers at this level, but again, it won’t be common and you can probably count with your fingers the amount of people that will get offers like these.&lt;/p&gt;

&lt;h3 id=&quot;infosec-is-fun-you-break-a-ton-of-stuff&quot;&gt;InfoSec is fun, you break a ton of stuff&lt;/h3&gt;

&lt;p&gt;I’d argue this sentence is correct, but incomplete. Infosec is a lot of fun, getting your first shell, finding your first 0day, getting that first CVE code with your name are a ton of fun and I can guarantee that these are moments you will remember for the entirety of your life.&lt;/p&gt;

&lt;p&gt;But then, what would we have to add to the sentence to make it complete?&lt;/p&gt;

&lt;p&gt;I’d argue the complete sentence would look like this “InfoSec is fun, you break a ton of stuff but it is also your responsability to help fix them”.&lt;/p&gt;

&lt;p&gt;We talk about the “breaking” side of things very often, we have entire presentations and conferences about vulnerabilities, red teaming, offensive security, but what about the output of those topics? What happens when you find a vulnerability?&lt;/p&gt;

&lt;p&gt;Thats when the “blue team” side of the coin comes out, and it is your responsability to act as a sheperd to developers, sysadmins, business owners and guide them on understanding the risk your brand new shiny vulnerability brings, which systems are affected, or how the code can be correctly fixed.&lt;/p&gt;

&lt;p&gt;Infosec when done right, isn’t an individual in a corner breaking things, it’s a collaboration to improve the overall security of an organization or an individual, and honestly I don’t think this is emphasized enough while people are at university, or early in their careers.&lt;/p&gt;

&lt;h3 id=&quot;infosec-rockstars&quot;&gt;Infosec Rockstars&lt;/h3&gt;

&lt;p&gt;Since before deciding to come to infosec I have met some of the smartest people I ever had the pleasure of having a dialog with in infosec.&lt;/p&gt;

&lt;p&gt;I have people that I dare say I’ve long admired and consider them some of my best friends, however… like everything else in life there are good things and bad things in infosec.&lt;/p&gt;

&lt;p&gt;The truly authentic rockstars, you will never hear them say they are “rockstars” or even act like it. They will simply help you, teach you, chat with you.&lt;/p&gt;

&lt;p&gt;There is a popular saying “Don’t meet your heroes”, in infosec I’d argue it should be “Meet your heroes, but do take them with a grain of salt until you’ve spent some actual time with them”&lt;/p&gt;

&lt;p&gt;You have two types of people.&lt;/p&gt;

&lt;p&gt;The “twitter infosec”, which if I had to make a comparison with would be like “instagram influencers” and then you have infosec people who are putting out good content, pushing others forward by helping them but that don’t try to push their persona and brand a la “twitter infosec”.&lt;/p&gt;

&lt;h3 id=&quot;fomo-on-defcon-blackhat-insert-super-expensive-well-known-security-conference-here&quot;&gt;FOMO on DefCon, BlackHat, &amp;lt;insert super expensive, well known security conference here&amp;gt;&lt;/h3&gt;

&lt;p&gt;You won’t be able to attend every conference, you will see tweets, you will see photos of the parties but guess what? You will be fine. These conferences are useful don’t get me wrong, but by not attending them you will not lose progress in your career. You see the real value of these conferences is the networking. Meeting people and that can be done at much cheaper, lower profile conferences. Plan properly and you will meet all the interesting people. Can’t go to conferences? Send them a tweet. The presentations are typically shared on twitter or youtube channels of the conferences so you will be able to see them anyway.&lt;/p&gt;

&lt;p&gt;If you really want to go to DefCon or BlackHat, then set it as a goal to present there. It will drive you and make you work harder on your craft, therefore actually improving your career.&lt;/p&gt;

&lt;h3 id=&quot;burnout-and-repetition&quot;&gt;Burnout and repetition&lt;/h3&gt;

&lt;p&gt;You will work hard schedules every now and then, if you work in foresics you will see things that will keep you up at night, the pressure is intense when you have a network under your responsabilities and there is a constant stream of new vulnerabilities coming out that you might need to keep track of, you will do month long security tests, produce a beautiful, well put out report, only to watch a client say “thanks we will take a look at it” and when you come back the year after things look exactly the same.&lt;/p&gt;

&lt;p&gt;You will go to conferences from previous point, hear about stories how a “rockstar” jumped into a garbage bin, found a name in a document, produced a card and then got access into a building, deployed a raspberry pi as a backdoor, only for you to go back to your day to day job, where you test web and mobile apps and find the exact same set of vulnerabilties in all of them, on some engagements maybe you get to do a larger scope that gets you in a network and you get to play with a little more freedom, because in the realworld actual red team engagements that involve those “fun scenarios”, are not all that common, because, clients aren’t prepared for them and would not be able to extract full value out of them.&lt;/p&gt;

&lt;h3 id=&quot;your-soft-skills-and-business-skills-will-take-you-very-far&quot;&gt;Your soft skills and business skills will take you very far&lt;/h3&gt;

&lt;p&gt;You need to learn how to speak to C-levels.&lt;/p&gt;

&lt;p&gt;Infosec is no longer a simple game where you can come in and break stuff.&lt;/p&gt;

&lt;p&gt;It’s much more than that.&lt;/p&gt;

&lt;p&gt;You need to know how to present to a board a vulnerability, and they won’t care about the technical part.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;What impact will this have on us? Of what type? Financial? Reputation?&lt;/li&gt;
  &lt;li&gt;Which assets will be affected?&lt;/li&gt;
  &lt;li&gt;Ok, you want to buy an item that costs X how many Y millions of potential damage will it save us from?&lt;/li&gt;
  &lt;li&gt;What is our business interruption plan in case we do get hacked?&lt;/li&gt;
  &lt;li&gt;One of our vendors just got hacked, which dependencies do we have on them?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Business decisions will often override security decisions, and hey, guess what?&lt;/p&gt;

&lt;p&gt;A few times this will be OK.&lt;/p&gt;

&lt;p&gt;Understanding how your business works, where revenue comes from, which clients you have are critical to you, so that you can properly find a way of aligning the requirements of security with the necessities of running the business.&lt;/p&gt;

&lt;p&gt;Also, you need to know how to correctly have a discussion with your peers and colleagues.&lt;/p&gt;

&lt;p&gt;Just having the technical knowledge, and going “I was right and you were wrong” ain’t gonna cut it. Be respectful and help others understand how to do things right and when you were wrong, say thanks and let the other person know you learned something new (hint: it’s infosec, you won’t ever know everything!).&lt;/p&gt;

&lt;p&gt;Be clear on your explanations, on your reports, on your presentations.&lt;/p&gt;

&lt;h3 id=&quot;infosec-is-still-an-inefficient-and-young-industry&quot;&gt;Infosec is still an inefficient and young industry&lt;/h3&gt;

&lt;p&gt;We keep hearing how there is a lack of resources, and it is true. But it is also true that as of this moment we as an industry are not applying our money in the correct places. There are plenty of things we do manually that could successfully be automated, and even sped up. We still chase IoC’s and signatures even though the past experience with AV’s have shown us that its a bad investment.&lt;/p&gt;

&lt;p&gt;We mock machine learning and cyberinsurance, when I’d argue a lot of infosec people don’t even understand how those things work or could be of use to us.&lt;/p&gt;

&lt;p&gt;But I also don’t fully blame infosec.&lt;/p&gt;

&lt;p&gt;We have had a ton of snake oil pushed on us, so we became sceptics. But new person that is coming, don’t fully buy our sceptisism, there are enough of us out there. Bring us new way of doing things, of automating parts of our work, help us scale and be better at what we do.&lt;/p&gt;

&lt;p&gt;We still make pew pew maps, even though we all agree ip geo location is bull&lt;em&gt;**&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;We all still do attribution based on weak sources, even though we all agree attribution is extremely hard to do correctly.&lt;/p&gt;

&lt;p&gt;We lack formalization, consistency, useful metrics and scientific methodology in our work in many ways. You can see it by asking specific questions to 10 different people in the industry and you might get 10 different answers.&lt;/p&gt;

&lt;h3 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h3&gt;

&lt;p&gt;Even after all this, there still isn’t another industry I would have chosen to be in for the beginning of my career. You get to learn about lots of different topics, there is a large spectrum of positions that you can take and with a field this young, there is plenty of impact to be made.&lt;/p&gt;</content><author><name></name></author><category term="infosec" /><category term="cybersecurity" /><summary type="html">Over the last 12 years, I’ve worked in multiple roles in Information Security, from being a pentester to analyst, leading an infosec team responsible for a multi-million dollar company to running my own company in infosec, and there a couple of learnings that I believe, if I had known before coming to infosec would have led to two important outcomes:</summary></entry><entry><title type="html">I want to block internet scanners!</title><link href="http://localhost:4000/internetscanning/cybersecurity/2019/10/27/blockinternetscanners.html" rel="alternate" type="text/html" title="I want to block internet scanners!" /><published>2019-10-27T02:56:18+02:00</published><updated>2019-10-27T02:56:18+02:00</updated><id>http://localhost:4000/internetscanning/cybersecurity/2019/10/27/blockinternetscanners</id><content type="html" xml:base="http://localhost:4000/internetscanning/cybersecurity/2019/10/27/blockinternetscanners.html">&lt;h3 id=&quot;hi-can-you-please-stop-scanning-me--my-ip-addresses-are-xxxxxxxxxxxx&quot;&gt;“Hi, can you please stop scanning me ? My IP Addresses are XXX.XXX.XXX.XXX”.&lt;/h3&gt;

&lt;p&gt;For years I received,read and replied to emails like these. As founder and CEO of a &lt;a href=&quot;https://binaryedge.io&quot;&gt;company&lt;/a&gt; who’s in the business of port scanning the Internet it is normal to see these types of emails. I always attempted to explain what we are doing, why we are doing it and why people should consider not having us block their IP addresses.&lt;/p&gt;

&lt;p&gt;The base premise of the complaints is that people don’t like us scanning their IP addresses and checking which ports are open.&lt;/p&gt;

&lt;p&gt;I won’t attempt to go into analogies on ports or windows and buildings as it’s not the objective of this post, this has been previously discussed and it is not a pandora box I intend to reopen here. Though, I will refer to one analogy at the end, however I would like to focus on trying to answer some questions that I typically get asked.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;“How can I block all internet scanners?”&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;In this article by using data, I will try to explain why this is not feasible, what are some of the benefits and the problems that come with attempting to do this.&lt;/p&gt;

&lt;h3 id=&quot;the-internet-is-a-noisy-place&quot;&gt;The Internet is a noisy place!&lt;/h3&gt;

&lt;p&gt;Every second, there are multiple actors scanning your IP address. There are multiple reasons for this and the data from understanding who is scanning the internet can be quite interesting as it enables answering lots of different questions blue teams (defenders) typically have.&lt;/p&gt;

&lt;p&gt;It’s because of the value of this data &lt;a href=&quot;https://blog.binaryedge.io/2019/02/07/listening-to-the-internet/&quot;&gt;BinaryEdge added the sensors&lt;/a&gt; to its data set or why &lt;a href=&quot;https://greynoise.viz&quot;&gt;GreyNoise&lt;/a&gt; exists.&lt;/p&gt;

&lt;p&gt;The following image gives you a visual perspective, of the quantity of traffic that the BinaryEdge sensors see in just 15 minutes split by the source country that the traffic originates from.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sensors-15m.gif&quot; alt=&quot;Data Source - binaryedge.io&quot; /&gt;&lt;/p&gt;

&lt;p&gt;What is important to understand is that similar to a lot of topics in infosec there are different shades of color to what the organizations generating this traffic are attempting to do. You have benign players like BinaryEdge, Rapid7, Censys and Shodan but what does benign mean in this context?&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;They respect blacklisting&lt;/strong&gt; - if you request one of these organizations not to scan you again they will respect your request&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;No active exploitation&lt;/strong&gt; - the scanning is focused merely on identifying services running on the internet, no active exploitation of vulnerabilities occurs at any point in time&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Benefit for you&lt;/strong&gt; - Most of these platforms allow you to check what data they have collected on your IP address. BinaryEdge allows you to check via &lt;a href=&quot;https://securityrating.io&quot;&gt;securityrating.io&lt;/a&gt; or via &lt;a href=&quot;https://app.binaryedge.io&quot;&gt;app.binaryedge.io&lt;/a&gt;, Rapid7 makes data available via their open data program and other players have their respective platforms.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;But, like everything else, there are also a lot of malicious actors on the internet and we will talk about their objectives in a few paragraphs.&lt;/p&gt;

&lt;p&gt;Multiple companies have honeypots or sensors on their internet facing perimeter to try and understand what the different actors are trying to do to them. And some companies spread sensors across multiple points of the internet and try to tag these actors and their actions.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.binaryedge.io/sensors-tags/&quot;&gt;Lots of different actions, actors and behaviours&lt;/a&gt; exist and happen on the internet.&lt;/p&gt;

&lt;p&gt;Over the course of 1 hour we see different actors and actions happening as seen by the following image which represents the amount of tagged events seen in the BinaryEdge platform for 1 hour.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sensor_wordcloud.png&quot; alt=&quot;Wordcloud Sensor Tags&quot; /&gt;&lt;/p&gt;

&lt;p&gt;From this image we can see the top seen action is&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ICMP_ECHO_REQUEST&lt;/strong&gt; - this means its a “ping” this makes sense as there are lots and lots of services checking for uptimes on machines worldwide, following this we have lots of different actors like &lt;strong&gt;BinaryEdge&lt;/strong&gt;, &lt;strong&gt;Censys&lt;/strong&gt;,&lt;strong&gt;Netsystems&lt;/strong&gt;, &lt;strong&gt;Shodan&lt;/strong&gt; and &lt;strong&gt;Rapid7&lt;/strong&gt; in a smaller quantity, we also see actions that happened over this hour in the form of &lt;strong&gt;HTTP&lt;/strong&gt;, &lt;strong&gt;SIP&lt;/strong&gt; and &lt;strong&gt;RDP Scans&lt;/strong&gt;.&lt;/p&gt;

&lt;h3 id=&quot;youre-targeting-me-on-your-attacks&quot;&gt;You’re targeting me on your attacks!&lt;/h3&gt;

&lt;p&gt;This is a common misconception that we also see people having. Specifically for the people doing internet wide scanning, you are not a special snowflake, this is actually a common factor between benign and malign internet wide scanning organizations. Neither of us cares about your specific IP address. We want to see the global picture. Rather than thinking from the perspective of “How am I gonna hack John Doe, that is behind IP address XXX.XXX.XXX.XX” we think on a global scale.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Benign actors&lt;/strong&gt; are looking to answer questions like:&lt;/p&gt;

&lt;p&gt;If a vendor fails to provide a patch, how many systems worldwide are affected?&lt;/p&gt;

&lt;p&gt;If a vulnerability for a router is released how many ISP’s worldwide have that router deployed?&lt;/p&gt;

&lt;p&gt;Do we see a specific country attacking another?&lt;/p&gt;

&lt;p&gt;And some of these are hard to answer, even looking at the same 1 hour sample of traffic, we see what appears to be a specific country focused on just targeting another country, like in the case of Germany, Moldova, or Panama .&lt;/p&gt;

&lt;p&gt;And this is where a big difference exists between the real and digital world. In general the concept of country means very little (exceptions exist).&lt;/p&gt;

&lt;p&gt;An American hacker, can hack a machine located in Brazil and use it to attack an IP address that belongs to France. Now imagine any mix and match combination of this that you might want, and you have a spaghetti puzzle on your hands. With the development of cloud systems, companies have servers in my different countries, even though they might have their HQ or satellite offices registered elsewhere.&lt;/p&gt;

&lt;p&gt;Everyone is scanning everyone and trying to tie to a country is not typically a good metric for attribution.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sensors_countries.png&quot; alt=&quot;Sensors - Events per country&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But what about &lt;strong&gt;malicious actors&lt;/strong&gt;? What are they trying to answer?&lt;/p&gt;

&lt;p&gt;Their questioning is typically focused around machine infection or cryptocurrency available to be stolen.&lt;/p&gt;

&lt;p&gt;You will often see scans that will identify the services running and then using the latest vulnerability that will give them control over a machine which they can then use on botnets, to mine cryptocurrency (due to changes in crypto prices you don’t see this as often anymore), or to install some type of ransomware that can give them a payday.&lt;/p&gt;

&lt;p&gt;In this case if you try to file an abuse request as you do with benign actors, they will not respect your request and will continue to scan your IP address, many times a way of filling an abuse can even not exist as some providers are collaborating with these bad actors.&lt;/p&gt;

&lt;h3 id=&quot;so-are-you-saying-my-worries-are-unfounded-for-wanting-to-block-internet-scanners&quot;&gt;So are you saying my worries are unfounded for wanting to block internet scanners?&lt;/h3&gt;

&lt;p&gt;No. Not at all. What I am trying to convey is that you are never going to be able to block them all. For as long as you have a device that is internet connected it will be scanned.&lt;/p&gt;

&lt;p&gt;By asking non-malicious actors to block your IP addresses, you are however losing visibility into your own exposure as well. You should try to leverage the tooling that the attackers use as well.&lt;/p&gt;

&lt;p&gt;Blocking an internet wide scanner, can bring you small benefits such as being removed from a tool like Shodan, BinaryEdge or Censys but it won’t fix your root problem.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The root problem…&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;If you’re exposing services you don’t think should be found by BinaryEdge, Censys or Shodan you shouldn’t be exposing them in the first place. Use these tools to your advantage, look for your company name, look for your IP addresses and understand what you are exposing.&lt;/p&gt;

&lt;p&gt;Situations we see often where you can use these tools for your benefit:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Firewall rule deployment fail&lt;/strong&gt; - ports are exposed that organisations thought that weren’t but because of some part of their process of deployment of firewall rules failed, these ports ended up exposed to the internet&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Lack of patching&lt;/strong&gt; - organisations forgetting to update some software running on their servers&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Visibility into targeted attacks&lt;/strong&gt; - Let’s say you do have proper logging and start seeing some weird traffic on your edge network that you haven’t before, check the internet scanners and sensors. Are they also seeing this? was it a new internet wide scanner that showed up and is looking for some new vulnerability?&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If I had to use an analogy, which I typically hate doing, its as if you have your building, with the windows without any curtains, internet wide scanners are the people on the street, and you are asking 5 out of 1000 on the street to cover their eyes and not look at your windows. And it just so happens that these 5 are the neighbors that would be respectful and tell you “Hey, I can see inside your house because you have no curtains”.&lt;/p&gt;

&lt;p&gt;If you don’t want people to see inside your house, you need to put curtains on your windows.&lt;/p&gt;</content><author><name></name></author><category term="internetscanning" /><category term="cybersecurity" /><summary type="html">“Hi, can you please stop scanning me ? My IP Addresses are XXX.XXX.XXX.XXX”.</summary></entry></feed>